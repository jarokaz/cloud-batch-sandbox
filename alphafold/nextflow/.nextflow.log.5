Nov-26 01:06:34.438 [main] DEBUG nextflow.cli.Launcher - $> nextflow run main.nf
Nov-26 01:06:34.550 [main] INFO  nextflow.cli.CmdRun - N E X T F L O W  ~  version 22.10.3
Nov-26 01:06:34.587 [main] DEBUG nextflow.plugin.PluginsFacade - Setting up plugin manager > mode=prod; embedded=false; plugins-dir=/home/user/.nextflow/plugins; core-plugins: nf-amazon@1.11.1,nf-azure@0.14.2,nf-codecommit@0.1.2,nf-console@1.0.4,nf-ga4gh@1.0.4,nf-google@1.4.5,nf-tower@1.5.6,nf-wave@0.5.2
Nov-26 01:06:34.602 [main] INFO  org.pf4j.DefaultPluginStatusProvider - Enabled plugins: []
Nov-26 01:06:34.603 [main] INFO  org.pf4j.DefaultPluginStatusProvider - Disabled plugins: []
Nov-26 01:06:34.607 [main] INFO  org.pf4j.DefaultPluginManager - PF4J version 3.4.1 in 'deployment' mode
Nov-26 01:06:34.620 [main] INFO  org.pf4j.AbstractPluginManager - No plugins
Nov-26 01:06:34.650 [main] DEBUG nextflow.config.ConfigBuilder - Found config local: /home/user/cloud-batch-sandbox/alphafold/nextflow/nextflow.config
Nov-26 01:06:34.651 [main] DEBUG nextflow.config.ConfigBuilder - Parsing config file: /home/user/cloud-batch-sandbox/alphafold/nextflow/nextflow.config
Nov-26 01:06:34.682 [main] DEBUG nextflow.config.ConfigBuilder - Applying config profile: `standard`
Nov-26 01:06:35.481 [main] DEBUG nextflow.cli.CmdRun - Applied DSL=2 from script declararion
Nov-26 01:06:35.525 [main] INFO  nextflow.cli.CmdRun - Launching `main.nf` [awesome_lorenz] DSL2 - revision: d6b4d36816
Nov-26 01:06:35.527 [main] DEBUG nextflow.plugin.PluginsFacade - Plugins default=[nf-google@1.4.5]
Nov-26 01:06:35.527 [main] DEBUG nextflow.plugin.PluginsFacade - Plugins resolved requirement=[nf-google@1.4.5]
Nov-26 01:06:35.527 [main] DEBUG nextflow.plugin.PluginUpdater - Installing plugin nf-google version: 1.4.5
Nov-26 01:06:35.554 [main] INFO  org.pf4j.AbstractPluginManager - Plugin 'nf-google@1.4.5' resolved
Nov-26 01:06:35.556 [main] INFO  org.pf4j.AbstractPluginManager - Start plugin 'nf-google@1.4.5'
Nov-26 01:06:35.595 [main] DEBUG nextflow.plugin.BasePlugin - Plugin started nf-google@1.4.5
Nov-26 01:06:35.613 [main] DEBUG nextflow.secret.LocalSecretsProvider - Secrets store: /home/user/.nextflow/secrets/store.json
Nov-26 01:06:35.619 [main] DEBUG nextflow.secret.SecretsLoader - Discovered secrets providers: [nextflow.secret.LocalSecretsProvider@44cffc25] - activable => nextflow.secret.LocalSecretsProvider@44cffc25
Nov-26 01:06:35.731 [main] DEBUG nextflow.Session - Session UUID: 4ef33642-08bd-4c0a-9abc-0c48871b676d
Nov-26 01:06:35.731 [main] DEBUG nextflow.Session - Run name: awesome_lorenz
Nov-26 01:06:35.732 [main] DEBUG nextflow.Session - Executor pool size: 8
Nov-26 01:06:36.017 [main] DEBUG nextflow.util.ThreadPoolBuilder - Creating thread pool 'FileTransfer' minSize=10; maxSize=24; workQueue=LinkedBlockingQueue[10000]; allowCoreThreadTimeout=false
Nov-26 01:06:36.052 [main] DEBUG nextflow.cli.CmdRun - 
  Version: 22.10.3 build 5834
  Created: 21-11-2022 21:37 UTC 
  System: Linux 5.15.65+
  Runtime: Groovy 3.0.13 on OpenJDK 64-Bit Server VM 17.0.5+8
  Encoding: UTF-8 (ANSI_X3.4-1968)
  Process: 3169@jk-af-dev-1 [172.17.0.3]
  CPUs: 8 - Mem: 31.4 GB (23.7 GB) - Swap: 0 (0)
Nov-26 01:06:36.095 [main] DEBUG nextflow.file.FileHelper - Can't check if specified path is NFS (1): gs://jk-aff-bucket/nextflow/alphafold

Nov-26 01:06:36.096 [main] DEBUG nextflow.Session - Work-dir: gs://jk-aff-bucket/nextflow/alphafold [null]
Nov-26 01:06:36.096 [main] DEBUG nextflow.Session - Script base path does not exist or is not a directory: /home/user/cloud-batch-sandbox/alphafold/nextflow/bin
Nov-26 01:06:36.130 [main] DEBUG nextflow.executor.ExecutorFactory - Extension executors providers=[GoogleLifeSciencesExecutor, GoogleBatchExecutor]
Nov-26 01:06:36.146 [main] DEBUG nextflow.Session - Observer factory: DefaultObserverFactory
Nov-26 01:06:36.179 [main] DEBUG nextflow.cache.CacheFactory - Using Nextflow cache factory: nextflow.cache.DefaultCacheFactory
Nov-26 01:06:36.198 [main] DEBUG nextflow.util.CustomThreadPool - Creating default thread pool > poolSize: 9; maxThreads: 1000
Nov-26 01:06:36.303 [main] DEBUG nextflow.Session - Session start
Nov-26 01:06:36.705 [main] DEBUG nextflow.script.ScriptRunner - > Launching execution
Nov-26 01:06:36.851 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: google-batch
Nov-26 01:06:36.851 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'google-batch'
Nov-26 01:06:36.854 [main] DEBUG nextflow.executor.Executor - [warm up] executor > google-batch
Nov-26 01:06:36.861 [main] DEBUG n.processor.TaskPollingMonitor - Creating task monitor for executor 'google-batch' > capacity: 1000; pollInterval: 10s; dumpInterval: 5m 
Nov-26 01:06:36.868 [main] DEBUG nextflow.cloud.google.GoogleOpts - Google auth via application DEFAULT
Nov-26 01:06:36.870 [main] DEBUG n.c.google.batch.GoogleBatchExecutor - [GOOGLE BATCH] Executor config=BatchConfig[googleOpts=GoogleOpts(projectId:jk-af-final, credsFile:null, location:us-central1, enableRequesterPaysBuckets:false, credentials:UserCredentials{requestMetadata=null, temporaryAccess=null, clientId=764086051850-6qr4p6gpi6hn506pt8ejuq83di341hur.apps.googleusercontent.com, refreshToken=1//04TeYasF5Wt-aCgYIARAAGAQSNwF-L9IreE6e7Xh_jRYGtCjynrOTKzDGN70ew8Df_WiLYv8Zalpi5DfqrUWhqfr4uQMrf5faWuE, tokenServerUri=https://oauth2.googleapis.com/token, transportFactoryClassName=com.google.auth.oauth2.OAuth2Utils$DefaultHttpTransportFactory, quotaProjectId=jk-af-final})
Nov-26 01:06:36.885 [main] DEBUG n.c.google.batch.client.BatchClient - [GOOGLE BATCH] Creating service client with config credentials
Nov-26 01:06:37.661 [main] DEBUG nextflow.Session - Workflow process names [dsl2]: run_data_pipeline
Nov-26 01:06:37.661 [main] DEBUG nextflow.Session - Igniting dataflow network (2)
Nov-26 01:06:37.662 [main] DEBUG nextflow.processor.TaskProcessor - Starting process > run_data_pipeline
Nov-26 01:06:37.663 [main] DEBUG nextflow.script.ScriptRunner - > Awaiting termination 
Nov-26 01:06:37.663 [main] DEBUG nextflow.Session - Session await
Nov-26 01:06:39.398 [Task submitter] DEBUG n.c.g.batch.GoogleBatchTaskHandler - [GOOGLE BATCH] submitted > job=nf-0bab5dd8-1669424798274; uid=j-3435b8fc-7831-4901-936c-11b4f691473f; work-dir=gs://jk-aff-bucket/nextflow/alphafold/0b/ab5dd856aa65d4d934a0adf37ab03b
Nov-26 01:06:39.399 [Task submitter] INFO  nextflow.Session - [0b/ab5dd8] Submitted process > run_data_pipeline (1)
Nov-26 01:09:16.926 [Task monitor] DEBUG n.c.g.batch.GoogleBatchTaskHandler - [GOOGLE BATCH] Terminated job=nf-0bab5dd8-1669424798274; state=FAILED
Nov-26 01:09:18.007 [Task monitor] DEBUG n.processor.TaskPollingMonitor - Task completed > TaskHandler[id: 1; name: run_data_pipeline (1); status: COMPLETED; exit: 1; error: -; workDir: gs://jk-aff-bucket/nextflow/alphafold/0b/ab5dd856aa65d4d934a0adf37ab03b]
Nov-26 01:09:18.151 [Task monitor] ERROR nextflow.processor.TaskProcessor - Error executing process > 'run_data_pipeline (1)'

Caused by:
  Process `run_data_pipeline (1)` terminated with an error exit status (1)

Command executed:

  python /runners/run_test.py '--text=Bonjour' '--features_path=features.pkl --msas_path=msas'

Command exit status:
  1

Command output:
  (more omitted..)
  6008555da505: Verifying Checksum
  6008555da505: Download complete
  e2250e4b9e64: Download complete
  0047db6c2358: Verifying Checksum
  0047db6c2358: Download complete
  d9960804702f: Download complete
  be7a8828f4d2: Download complete
  320b8621e9d3: Download complete
  1b53decda963: Verifying Checksum
  1b53decda963: Download complete
  6133a7670aff: Verifying Checksum
  6133a7670aff: Download complete
  07414aeb81b6: Verifying Checksum
  07414aeb81b6: Download complete
  e2250e4b9e64: Pull complete
  9cf40c59065f: Pull complete
  5e609a938304: Pull complete
  f3f2f506d212: Pull complete
  b4ca963de55e: Pull complete
  83a0e5e3c82b: Pull complete
  07414aeb81b6: Pull complete
  3e45a0c08bfc: Pull complete
  6008555da505: Pull complete
  6133a7670aff: Pull complete
  0047db6c2358: Pull complete
  d9960804702f: Pull complete
  be7a8828f4d2: Pull complete
  320b8621e9d3: Pull complete
  1b53decda963: Pull complete
  Digest: sha256:9c70f5edda8241cbed45c5caf5196c24ae87614f6d65141d0f07f5a027249d4a
  Status: Downloaded newer image for gcr.io/jk-af-final/alphafold:latest
  gcr.io/jk-af-final/alphafold:latest
  /opt/conda/lib/python3.7/site-packages/haiku/_src/data_structures.py:37: FutureWarning: jax.tree_structure is deprecated, and will be removed in a future release. Use jax.tree_util.tree_structure instead.
    PyTreeDef = type(jax.tree_structure(None))
  I1126 01:09:02.384943 139825113843520 run_test.py:36] Running test
  I1126 01:09:02.385067 139825113843520 run_test.py:37] Bonjour
  I1126 01:09:02.385113 139825113843520 run_test.py:40] Saving features to features.pkl --msas_path=msas
  Bonjour
  Traceback (most recent call last):
    File "/runners/run_test.py", line 49, in <module>
      app.run(_main)
    File "/opt/conda/lib/python3.7/site-packages/absl/app.py", line 312, in run
      _run_main(main, args)
    File "/opt/conda/lib/python3.7/site-packages/absl/app.py", line 258, in _run_main
      sys.exit(main(argv))
    File "/runners/run_test.py", line 45, in _main
      with open(os.path.join(FLAGS.msas_path, 'test.fasta')) as f:
    File "/opt/conda/lib/python3.7/posixpath.py", line 80, in join
      a = os.fspath(a)
  TypeError: expected str, bytes or os.PathLike object, not NoneType

Command error:
  /opt/conda/lib/python3.7/site-packages/haiku/_src/data_structures.py:37: FutureWarning: jax.tree_structure is deprecated, and will be removed in a future release. Use jax.tree_util.tree_structure instead.
    PyTreeDef = type(jax.tree_structure(None))
  I1126 01:09:02.384943 139825113843520 run_test.py:36] Running test
  I1126 01:09:02.385067 139825113843520 run_test.py:37] Bonjour
  I1126 01:09:02.385113 139825113843520 run_test.py:40] Saving features to features.pkl --msas_path=msas
  Traceback (most recent call last):
    File "/runners/run_test.py", line 49, in <module>
      app.run(_main)
    File "/opt/conda/lib/python3.7/site-packages/absl/app.py", line 312, in run
      _run_main(main, args)
    File "/opt/conda/lib/python3.7/site-packages/absl/app.py", line 258, in _run_main
      sys.exit(main(argv))
    File "/runners/run_test.py", line 45, in _main
      with open(os.path.join(FLAGS.msas_path, 'test.fasta')) as f:
    File "/opt/conda/lib/python3.7/posixpath.py", line 80, in join
      a = os.fspath(a)
  TypeError: expected str, bytes or os.PathLike object, not NoneType

Work dir:
  gs://jk-aff-bucket/nextflow/alphafold/0b/ab5dd856aa65d4d934a0adf37ab03b

Tip: you can try to figure out what's wrong by changing to the process work dir and showing the script file named `.command.sh`
Nov-26 01:09:18.164 [main] DEBUG nextflow.Session - Session await > all processes finished
Nov-26 01:09:18.192 [Task monitor] DEBUG nextflow.Session - Session aborted -- Cause: Process `run_data_pipeline (1)` terminated with an error exit status (1)
Nov-26 01:09:18.291 [main] DEBUG nextflow.Session - Session await > all barriers passed
Nov-26 01:09:18.373 [main] DEBUG nextflow.trace.WorkflowStatsObserver - Workflow completed > WorkflowStats[succeededCount=0; failedCount=1; ignoredCount=0; cachedCount=0; pendingCount=0; submittedCount=0; runningCount=0; retriesCount=0; abortedCount=0; succeedDuration=0ms; failedDuration=1.1s; cachedDuration=0ms;loadCpus=0; loadMemory=0; peakRunning=1; peakCpus=1; peakMemory=0; ]
Nov-26 01:09:18.384 [main] DEBUG nextflow.cache.CacheDB - Closing CacheDB done
Nov-26 01:09:18.385 [main] INFO  org.pf4j.AbstractPluginManager - Stop plugin 'nf-google@1.4.5'
Nov-26 01:09:18.385 [main] DEBUG nextflow.plugin.BasePlugin - Plugin stopped nf-google
Nov-26 01:09:18.404 [main] DEBUG nextflow.script.ScriptRunner - > Execution complete -- Goodbye
